!function(t){t.fn.collagePlus=function(e){function i(e,i,n,o){for(var d=n.padding*(e.length-1)+e.length*e[0][3],s=n.albumWidth-d,l=s/(i-d),r=d,c=i<n.albumWidth?!0:!1,h=0;h<e.length;h++){var u=t(e[h][0]),f=Math.floor(e[h][1]*l),g=Math.floor(e[h][2]*l),p=!!(h<e.length-1);n.allowPartialLastRow===!0&&c===!0&&(f=e[h][1],g=e[h][2]),r+=f,!p&&r<n.albumWidth&&(n.allowPartialLastRow===!0&&c===!0?f=f:f+=n.albumWidth-r),f--;var m=u.is("img")?u:u.find("img");m.width(f),u.is("img")||u.width(f+e[h][3]),m.height(g),u.is("img")||u.height(g+e[h][4]),a(u,p,n),m.one("load",function(t){return function(){if("default"==n.effect)t.animate({opacity:"1"},{duration:n.fadeSpeed});else{if("vertical"==n.direction)var e=10>=o?o:10;else var e=9>=h?h+1:10;t.removeClass(function(t,e){return(e.match(/\beffect-\S+/g)||[]).join(" ")}),t.addClass(n.effect),t.addClass("effect-duration-"+e)}}}(u)).each(function(){this.complete&&t(this).trigger("load")})}}function a(t,e,i){var a={"margin-bottom":i.padding+"px","margin-right":e?i.padding+"px":"0px",display:i.display,"vertical-align":"bottom",overflow:"hidden"};return t.css(a)}function n(e){$img=t(e);var i=new Array;return i.w=parseFloat($img.css("border-left-width"))+parseFloat($img.css("border-right-width")),i.h=parseFloat($img.css("border-top-width"))+parseFloat($img.css("border-bottom-width")),i}return this.each(function(){var a=0,o=[],d=1,s=t(this);t.fn.collagePlus.defaults.albumWidth=s.width(),t.fn.collagePlus.defaults.padding=parseFloat(s.css("padding-left")),t.fn.collagePlus.defaults.images=s.children();var l=t.extend({},t.fn.collagePlus.defaults,e);l.images.each(function(e){var s=t(this),r=s.is("img")?s:t(this).find("img"),c="undefined"!=typeof r.data("width")?r.data("width"):r.width(),h="undefined"!=typeof r.data("height")?r.data("height"):r.height(),u=n(r);r.data("width",c),r.data("height",h);var f=Math.ceil(c/h*l.targetHeight),g=Math.ceil(l.targetHeight);o.push([this,f,g,u.w,u.h]),a+=f+u.w+l.padding,a>l.albumWidth&&0!=o.length&&(i(o,a-l.padding,l,d),delete a,delete o,a=0,o=[],d+=1),l.images.length-1==e&&0!=o.length&&(i(o,a,l,d),delete a,delete o,a=0,o=[],d+=1)})})},t.fn.collagePlus.defaults={targetHeight:400,fadeSpeed:"fast",display:"inline-block",effect:"default",direction:"vertical",allowPartialLastRow:!1}}(jQuery),function(t){t.fn.removeWhitespace=function(){return this.contents().filter(function(){return 3==this.nodeType&&!/\S/.test(this.nodeValue)}).remove(),this}}(jQuery),function(t){t.fn.collageCaption=function(e){var i={images:t(this).children(),background:"black",opacity:"0.5",speed:100,cssClass:"Caption"},a=t.extend({},i,e);return this.each(function(){return a.images.each(function(e){var i=t(this);if("undefined"!=typeof i.data("caption")){var n='<div class="'+a.cssClass+'" style="position:relative;"><div class="Caption_Background" style="background-color:'+a.background+";opacity:"+a.opacity+';position:relative;top:0;"></div><div class="Caption_Content" style="position:relative;">'+i.data("caption")+"</div></div>";i.append(n);var o=i.find("."+a.cssClass),d=i.find(".Caption_Background"),s=i.find(".Caption_Content"),l=o.height();d.height(l),s.css("top","-"+l+"px"),i.bind({mouseenter:function(t){o.animate({top:-1*l},{duration:a.speed,queue:!1})},mouseleave:function(t){o.animate({top:0},{duration:a.speed,queue:!1})}})}}),this})}}(jQuery);