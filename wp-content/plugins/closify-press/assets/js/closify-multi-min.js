jQuery.noConflict(),function(a){a.fn.arfaly=function(e){function i(e,i){a("#arfaly-info-box-"+e).find(".arfaly-info-internal-content").html(i)}function t(e){p.config.debug&&(a(p.config.targetOutput).is(":visible")?a(".output-list-"+r.attr("id")).append("<li>"+e+"</li>"):(a(p.config.targetOutput).html('<br><ol class="output-list-'+r.attr("id")+'"><li>'+e+"</li></ol>"),a(p.config.targetOutput).delay(300).slideDown()))}function s(a){a.stopPropagation(),a.preventDefault(),r.find("#arfaly-filedrag").removeClass("hover").addClass("");var e=a.target.files||a.originalEvent.dataTransfer.files;l(e)}function l(e){var s=e;for(j=0;j<s.length;j++){if(d>=p.config.limitNumberofFiles)return t("You have exceed upload limit ("+d+") !"),!1;if(0!=s[j].length){var l=new FormData;l.append("SelectedFile",s[j]),l.append("action",p.config.action),l.append("closify-id",r.attr("closify-id")),l.append("closify-idx",r.attr("closify-idx")),l.append("fileIndx",d),l.append("nonce",p.config.nonce),j==s.length-1&&l.append("patch-finished","true"),0==j&&l.append("patch-started","true"),p.addFileItem(s[j].name,d);var o=p.beforeSubmit(s[j],d);if(null==n?a("#uploadItem-"+r.attr("id")+"-"+d).find("#mimePicture").addClass("closify-icon-file"):a("#uploadItem-"+r.attr("id")+"-"+d).find("#mimePicture").addClass(n),1==o.status){var f=new XMLHttpRequest;c[d]=f,c[d].index=d,c[d].cachedData=l,c[d].onreadystatechange=function(){if(4==this.readyState){a("#uploadItem-"+r.attr("id")+"-"+this.index).find(".arfaly-loading").css("display","block"),a("#uploadItem-"+r.attr("id")+"-"+this.index).find(".arfaly-ready").hide();try{var e=JSON.parse(this.response);"true"==e.status?(e.attid&&r.find("#file-"+this.index+"-"+r.attr("id")).val(e.attid),p.tagItemSuccess(this.index,!0,e.data),null!=e.newFileName&&a("#"+this.index+"-fileName").text(e.newFileName),null!=e.fullPath&&a("#preview-"+r.attr("id")+"-"+this.index).attr("link",e.fullPath),1==p.config.disablePostProgressAnimation&&(1==p.config.disablePostProgressAnimation&&r.find("#progress-style-"+this.index).addClass("arfaly-nostripes"),r.find("#progress-style-"+this.index).addClass("arfaly-nostripes")),p.config.successfulUpload(e)):(p.tagItemSuccess(this.index,!1,e.error),p.config.failedUpload(e),i(this.index,e.error))}catch(t){e={status:"error",msg:"Response string format is not a valid JSON: ["+this.responseText+"]"},p.tagItemSuccess(this.index,!1,e.msg)}}},c[d].upload.index=d,c[d].upload.addEventListener("progress",function(e){var i=e.loaded/e.total*100,t=this.index;a("#massUploadProgress-"+r.attr("id")+"-"+this.index).css("width",i+"%"),i>=100&&!p.config.disableRemovingItems&&setTimeout(function(){p.deleteItem(t)},p.config.delay)},!1),p.config.enforceInfo||(c[d].open(p.config.type,p.config.url),c[d].send(l)),d++}else p.tagItemSuccess(d,!1,o.responseText),d++}}return 0}function o(a,e,i){c[a].cachedData.append("title",e),c[a].cachedData.append("desc",i),c[a].open(p.config.type,p.config.url),c[a].send(c[a].cachedData),c[a]="invalid"}var n,r=this,d=0,c=[],f=new Asas({dataBits:8,codeBits:6,keyString:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pad:"="}),p={init:function(){p.config=a.extend({allowedFileSize:10485760,delay:5e3,multi:!0,url:"processMultipleUploads.php",dataType:"json",limitNumberofFiles:10,isGuest:!0,enforceInfo:!1,enterTitleLbl:"Enter Upload Title",enterDescLbl:"Enter Upload Description",enterEmailLbl:"Enter your email",disablePreview:!1,enterName:"Enter your name",label:"Allowed file types are gif, jpg, and png.",debug:!1,dragDrop:!0,targetOutput:".output",type:"post",nonce:"",theme:"default",disablePostProgressAnimation:!0,disableRemovingItems:!0,backgroundColor:"",logoColor:"rgb(150, 155, 255)",textColor:"#DADADA",borderColor:"#DADADA",labelColor:"rgb(90, 90, 90)",progressBarColor:"orange",action:"itech_arfaly_submission",beforeSubmit:p.beforeSubmit,successfulUpload:p.successfulUpload,failedUpload:p.failedUpload,fileDeleted:p.fileDeleted},e),p.Setup(),a(p.config.targetOutput).hide()},Setup:function(){var a="",e="";p.config.multi&&(a="multiple"),"false"!=p.config.dragDrop&&(e="display:none");var i='<input type="hidden" name="action" value="itech_mass_upload_submission" />',t='<p class="arfaly-label" style="color:'+p.config.labelColor+'">'+p.config.label+"</p>",s='<div><div id="arfaly-filedrag" style="color: '+p.config.textColor+";border: 9px dashed "+p.config.borderColor+';"><span class="arfaly-showcase closify-icon-cloud-storage" style="color:'+p.config.logoColor+'"></span><br/>Drop files here</div><br/>'+t+"</div>",l='<input type="file" style="'+e+'" name="files[]" id="'+r.attr("id")+'-arfaly-files" '+a+"><br/>",o="<br/>",n='<div id="'+r.attr("id")+'-ListItem" class="arfaly-multi-images"></div>';r.addClass("arfaly-multiple-upload"),"false"!=p.config.dragDrop?r.html(i+s+l+n):r.html(i+l+o+t+n)},bytesToSize:function(a){var e=["Bytes","KB","MB","GB","TB"];if(0==a)return"0 Bytes";var i=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,i),2)+" "+e[i]},successfulUpload:function(a){},failedUpload:function(a){},fileDeleted:function(e){e.fileIdx;a.ajax({url:p.config.url,type:"POST",data:e,success:function(a){t(a)}})},beforeSubmit:function(a,e){var i=[],t=navigator.userAgent.indexOf("Chrome")>-1,s=navigator.userAgent.indexOf("Safari")>-1;if(t&&s&&(s=!1),window.File&&window.FileReader&&window.FileList&&window.Blob){var l=a.size,o=a.type;switch(o){case"application/octet-stream":case"application/postscript":case"image/png":case"image/gif":case"image/jpeg":case"image/pjpeg":case"image/x-png":case"image/jpg":case"image/x-windows-bmp":case"image/bmp":case"image/tiff":case"image/x-tiff":case"image/svg+xml":n="closify-icon-photo";break;case"audio/aac":case"audio/mp4":case"audio/mp3":case"audio/ogg":case"audio/wav":case"audio/webm":n="closify-icon-music";break;case"video/mp4":case"video/ogg":case"video/webm":case"video/avi":case"video/mkv":case"video/x-matroska":n="closify-icon-video2";break;case"application/x-zip-compressed":case"application/zip":case"application/x-rar-compressed":n="closify-icon-wallet";break;default:n="closify-icon-file"}return l>p.config.allowedFileSize?(i.status=!1,i.responseText=p.bytesToSize(l)+": The file size has exceeded the limit ("+p.config.allowedFileSize/1024/1024+"MB) !",i):(i.status=!0,i)}return i.status=!1,i.responseText="Please upgrade your browser, because your current browser lacks some new features we need!",i},deleteItem:function(e){var i={"arfaly-id":r.attr("id"),command:"delete",arfalyfn:f.encode(r.find("#"+e+"-fileName").text()),fileIndx:e,action:p.config.action,nonce:p.config.nonce,raqmkh:f.encode(r.find("#file-"+e+"-"+r.attr("id")).val())};p.config.fileDeleted(i),a("#uploadItem-"+r.attr("id")+"-"+e).addClass("animated bounceOutRight"),setTimeout(function(i){a("#uploadItem-"+r.attr("id")+"-"+e).remove()},600)},addFileItem:function(e,i){var t="",s="";p.config.disablePreview||(t='<a rel="external" link="" id="preview-'+r.attr("id")+"-"+i+'" index="'+i+'" class="arfaly-preview"><span class="closify-icon-earth" title="Preview file"></span></a>',s='<a class="arfaly-button arfaly-preview noselect" index="'+i+'" >Preview</a>');var l='<input type="hidden" id="file-'+i+"-"+r.attr("id")+'" name="image-id[]" value="" />',n='<div id="arfaly-info-box-'+i+'" class="info-box noselect"><div class="arfaly-info-p"><a class="arfaly-close" index="'+i+'"><span class="arfaly-info-close closify-icon-delete"></span></a><div class="arfaly-info-internal-content">Everything going well so far!</div></div><div class="arfaly-pointer"></div></div>',d='<div class="clearfix" style="margin-bottom:10px"><input class="arfaly-input" type="text" name="arfaly-title" placeholder="'+p.config.enterTitleLbl+'" required/><br><textarea rows="2" class="arfaly-input" type="textarea" name="arfaly-desc" placeholder="'+p.config.enterDescLbl+'" required/><a class="arfaly-button arfaly-upload noselect" index="'+i+'">Upload</a><a class="arfaly-button arfaly-delete noselect" id="'+i+'">Delete</a>'+s+"</div>";p.config.enforceInfo||(d="");var f='<a class="info-icon" index="'+i+'"><span class="arfaly-info-icon closify-icon-info" ></span></a>',u='<a class="info-icon" index="'+i+'" title="Information Button"><span class="closify-icon-info-large"></span></a>',y='<div id="uploadItem-'+r.attr("id")+"-"+i+'" class="arfaly-default-theme"><div class="arfaly-oval"><span class="arfaly-ready closify-icon-plus" style="margin-top:34px;"></span><span class="arfaly-loading closify-icon-spinner"></span><div id="mass-item-success-'+r.attr("id")+"-"+i+'" class="notification-oval"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+r.attr("id")+"-"+i+'"><li class="arfaly-tick-text" id="mass-item-success-text-'+r.attr("id")+"-"+i+'" style=";color:white;font-family:cursive;font-size:10px;color:white"></li></li></ul></div></div><div class="arfaly-list-div noselect" style="background-color:'+p.config.backgroundColor+'" >'+l+'<div><div class="arfaly-list-icon arfaly-left"><span id="mimePicture" class="icon" style="font-size:40px"></span></div><div class="progress-container arfaly-right"><div id="progress-style-'+i+'" class="arfaly-meter '+p.config.progressBarColor+' arfaly-right"><span id="massUploadProgress-'+r.attr("id")+"-"+i+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+i+'-fileName" class="arfaly-filename">'+e+'</div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+i+'"><span class="closify-icon-remove" title="Delete this file"></span></a>&nbsp;'+t+"</li></ul></div></div>"+f+"</div></div>"+d+"</div>",m='<div id="uploadItem-'+r.attr("id")+"-"+i+'" class="theme-1"><div class="arfaly-list-div noselect" style="background-color:'+p.config.backgroundColor+'">'+l+'<div><div class="progress-container arfaly-left"><div id="progress-style-'+i+'" class="arfaly-meter '+p.config.progressBarColor+' arfaly-left"><span id="massUploadProgress-'+r.attr("id")+"-"+i+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+i+'-fileName" class="arfaly-filename">'+e+'</div></div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+i+'"><span class="closify-icon-remove" title="Delete this file"></span></a>&nbsp;'+t+"&nbsp;"+u+'<div class="arfaly-oval"><span class="arfaly-ready closify-icon-plus"></span><span class="arfaly-loading closify-icon-spinner" style="display: none;"></span><div id="mass-item-success-'+r.attr("id")+"-"+i+'" class="notification-oval" style="margin-top: 1px"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+r.attr("id")+"-"+i+'"></ul></div></div></li></ul></div><div class="arfaly-list-icon arfaly-right"><span id="mimePicture" class="icon" style="font-size:40px"></span></div></div></div>'+d+"</div>",g='<div id="uploadItem-'+r.attr("id")+"-"+i+'" class="theme-2"><div class="arfaly-list-div noselect" style="background-color:'+p.config.backgroundColor+'">'+l+'<div><div class="progress-container arfaly-left"><div id="progress-style-'+i+'" class="arfaly-meter '+p.config.progressBarColor+' arfaly-right"><span id="massUploadProgress-'+r.attr("id")+"-"+i+'" style="width: 0%;" class="arfaly-span-progress"></span></div><div id="'+i+'-fileName" class="arfaly-filename">'+e+'</div></div><div class="arfaly-list-menu arfaly-right"><ul><li><a class="arfaly-delete" id="'+i+'"><span class="closify-icon-remove" title="Delete this file"></span></a>&nbsp;'+t+'<a class="info-icon" index="'+i+'" title="Information Button"><span class="closify-icon-info-large"></span></a><div class="arfaly-oval"><span class="arfaly-ready closify-icon-plus"></span><span class="arfaly-loading closify-icon-spinner" style="display: none;"></span><div id="mass-item-success-'+r.attr("id")+"-"+i+'" class="notification-oval"><ul class="arfaly-oval-list-info" id="mass-item-oval-info-'+r.attr("id")+"-"+i+'"></ul></div></div></li></ul></div></div></div>'+d+"</div>",v=m;switch(p.config.theme){case"default":v=y;break;case"simplex":v=m;break;case"super-simplex":v=g;break;default:v=m}a("#"+r.attr("id")+"-ListItem").prepend(v),jQuery("body").prepend(n),p.config.enforceInfo||(a("#uploadItem-"+r.attr("id")+"-"+i).find(".arfaly-loading").css("display","block"),a("#uploadItem-"+r.attr("id")+"-"+i).find(".arfaly-ready").hide());var h=a("#uploadItem-"+r.attr("id")+"-"+i).find(".arfaly-oval").height()-a("#mass-item-success-"+r.attr("id")+"-"+i).height();a("#mass-item-success-"+r.attr("id")+"-"+i).css("margin-top",h/2+"px"),a("#uploadItem-"+r.attr("id")+"-"+i).find("a.arfaly-delete").click(function(){var e=confirm("Are you sure you want to delete the file?");if(e){var i=a(this).attr("id");p.deleteItem(i)}});var b,x;"default"==p.config.theme?(x=-35,b=25):(x=25,b=-100),a("#uploadItem-"+r.attr("id")+"-"+i).find("a.info-icon").click(function(e){a("#arfaly-info-box-"+i).css("top",e.pageY+x),a("#arfaly-info-box-"+i).css("left",e.pageX+b),a("#arfaly-info-box-"+i).slideDown()}),a("#arfaly-info-box-"+i).find("a.arfaly-close").click(function(e){var i=a(this).attr("index");a("#arfaly-info-box-"+i).slideUp()}),a(document).mouseup(function(e){var i=a(".info-box");i.is(e.target)||0!==i.has(e.target).length||i.hide()}),a("#uploadItem-"+r.attr("id")+"-"+i).find("a.arfaly-preview").click(function(){var e=a(this).attr("index");""!=a("#preview-"+r.attr("id")+"-"+e).attr("link")&&window.open(a("#preview-"+r.attr("id")+"-"+e).attr("link"),"_blank")}),p.config.enforceInfo&&a("#uploadItem-"+r.attr("id")+"-"+i).find("a.arfaly-upload").click(function(){var e=a(this).attr("index"),i=a("#uploadItem-"+r.attr("id")+"-"+e).find('input[name="arfaly-title"]'),t=a("#uploadItem-"+r.attr("id")+"-"+e).find('textarea[name="arfaly-desc"]'),s=i.val(),l=t.val();return"undefined"==typeof s||""==s?(a(i).focus(),!1):"undefined"==typeof l||""==l?(a(t).focus(),!1):void(null!=c[e]&&o(e,s,l))}),a("div.arfaly-list-div").click(function(a){a.preventDefault()})},tagItemSuccess:function(e,s,l){a("#uploadItem-"+r.attr("id")+"-"+e).find(".arfaly-loading").hide(),a("#uploadItem-"+r.attr("id")+"-"+e).find(".notification-oval").css("display","inline-block");var o;s?(a("#uploadItem-"+r.attr("id")+"-"+e).find(".arfaly-preview")&&a("#uploadItem-"+r.attr("id")+"-"+e).find(".arfaly-preview").fadeIn(),a("#uploadItem-"+r.attr("id")+"-"+e).find(".arfaly-delete").fadeIn(),o='<li class="closify-icon-tick center-icon" style="font-size:13px;color:white"></li>'):(o='<li class="closify-icon-times center-icon" style="font-size:13px;color:white"></li>',i(e,l)),"true"!=a("#mass-item-success-"+r.attr("id")+"-"+e).attr("updated")&&(a("#mass-item-oval-info-"+r.attr("id")+"-"+e).prepend(o),a("#mass-item-success-"+r.attr("id")+"-"+e).attr("title",l),a("#uploadItem-"+r.attr("id")+"-"+e).attr("title",l),a("#mass-item-success-"+r.attr("id")+"-"+e).addClass("animated "+(s?"flipNotificationSuccess":"flipNotificationError")),a("#mass-item-success-text-"+r.attr("id")+"-"+e).html(s?"Succeed":"Failed"),a("#mass-item-success-"+r.attr("id")+"-"+e).attr("updated","true"),t(l))},fileDragHover:function(a){a.stopPropagation(),a.preventDefault(),r.find("#arfaly-filedrag").removeClass("hover").addClass("dragover"==a.type?"hover":"")}};p.init();var u=r.find("#arfaly-filedrag");u.on("dragover",p.fileDragHover),u.on("dragleave",p.fileDragHover),u.on("drop",s),u.css("display","block"),u.click(function(){a("input[id="+r.attr("id")+"-arfaly-files]").click()}),this.find("input[type=file]").change(function(){l(this.files)})}}(jQuery);